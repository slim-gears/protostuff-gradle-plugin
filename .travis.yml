language: java
jdk: openjdk14
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
    - "$HOME/.gradle/caches/"
    - "$HOME/.gradle/wrapper/"
deploy:
  provider: script
  script: >-
      ./gradlew publishPlugins publish
                -Dgradle.publish.key=$GRADLE_PUBLISH_KEY
                -Dgradle.publish.secret=$GRADLE_PUBLISH_SECRET
                -Dsigning.keyId=$SIGNING_KEY_ID
                -Dsigning.password=
                -Dsigning.secretKeyRingFile=key.gpg
                -Dmeta.version=$TRAVIS_TAG
  skip_cleanup: true
  on:
    tags: true
